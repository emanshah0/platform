const getPrintContents = () => {
  return components.map((component, index) => {
    if (component.type === LineGraph) {
      const chartRef = React.createRef();

      // Wait for the LineGraph component to be rendered in the DOM
      const onLineGraphRender = () => {
        const chartInstance = chartRef.current?.chartInstance;

        if (chartInstance) {
          const imageSrc = getChartImage(chartInstance);
          const imageElement = `<img src="${imageSrc}" alt="Line Graph" />`;

          const wrapperElement = document.createElement('div');
          wrapperElement.innerHTML = imageElement;
          return wrapperElement.firstChild.outerHTML;
        }
      };

      return (
        <div key={index} className="component-wrapper">
          <LineGraph {...component.props} chartRef={chartRef} onRender={onLineGraphRender} />
        </div>
      );
    }

    return (
      <div key={index} className="component-wrapper">
        {ReactDOMServer.renderToStaticMarkup(component)}
      </div>
    );
  }).join('');
};

const getChartImage = (chartInstance) => {
  const canvas = chartInstance.canvas;
  return canvas.toDataURL();
};
